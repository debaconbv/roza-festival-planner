<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoZa Festival 2026 - Line-up Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Fredoka', sans-serif;
        }
        
        .poster-view {
            background: 
                repeating-linear-gradient(
                    45deg,
                    #FF9AA2,
                    #FFB7B2 50px,
                    #FFDAC1 50px,
                    #FFDAC1 100px,
                    #FFB7B2 100px,
                    #FFB7B2 150px,
                    #FF9AA2 150px,
                    #FF9AA2 200px
                );
            font-family: 'Fredoka', sans-serif;
        }
        
        .roza-title {
            font-family: 'Fredoka', sans-serif;
            font-weight: 700;
            color: #1a2238;
        }
        
        .roza-bg {
            background: linear-gradient(135deg, #FFB7B2 0%, #FF9AA2 50%, #FFDAC1 100%);
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1a2238;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Touch-friendly drag & drop */
        .touch-none {
            -webkit-user-select: none;
            user-select: none;
        }

        /* Visual feedback tijdens drag */
        [draggable="true"] {
            cursor: grab;
        }

        [draggable="true"]:active {
            cursor: grabbing;
        }

        /* Smooth transitions */
        [data-drop-zone] {
            transition: all 0.2s ease;
        }

        /* Drop zone visual feedback */
        [data-drop-zone].drag-over {
            transform: scale(1.02);
        }

        /* Swipe feedback animation */
        @keyframes swipeFeedback {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            80% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script>
        // VERVANG DEZE URL MET JOUW GOOGLE SHEET CSV EXPORT URL
        const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQlf_lAOPrCrIq-vQ5To-129nW60GhxMh5w_j4x6uRHQnV8lPXSAxXkgcQjbS8qWlBBBy-DNTVP7l02/pub?gid=0&single=true&output=csv';
        
        const FALLBACK_CONFIG = {
            festivalNaam: "RoZa Festival",
            datum: "12 september 2026",
            locatie: "Zammel, Geel",
            totaleBudget: 10000
        };

        class FestivalApp {
            constructor() {
                this.currentUser = localStorage.getItem('roza_user') || null;
                this.scenarios = [];
                this.activeScenarioId = 1;
                this.showPosterView = false;
                this.draggedBand = null;
                this.dragSource = null;
                this.editingScenarioId = null;
                this.editName = '';
                this.isLoading = true;
                this.CONFIG = FALLBACK_CONFIG;
                this.allBands = [];
                
                // Touch support variables
                this.touchStartY = 0;
                this.touchStartX = 0;
                this.touchStartTime = 0;
                this.isDragging = false;
                this.draggedElement = null;
                this.placeholder = null;
                this.scrollInterval = null;
                
                this.init();
            }

            async init() {
                if (!this.currentUser) {
                    this.showLoginPrompt();
                } else {
                    this.showLoadingScreen();
                    await this.loadDataFromGoogleSheets();
                    this.scenarios = this.loadScenarios();
                    this.activeScenarioId = parseInt(localStorage.getItem('roza_active_scenario')) || 1;
                    this.isLoading = false;
                    this.render();
                }
            }

            showLoadingScreen() {
                const app = document.getElementById('app');
                app.innerHTML = `
                    <div class="min-h-screen flex items-center justify-center roza-bg">
                        <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-md w-full text-center">
                            <div class="loading-spinner mx-auto mb-4"></div>
                            <p class="text-xl font-bold roza-title">Bands laden...</p>
                            <p class="text-gray-600 mt-2">Even geduld terwijl we de laatste data ophalen</p>
                        </div>
                    </div>
                `;
            }

            async loadDataFromGoogleSheets() {
                try {
                    console.log('üîÑ Loading data from Google Sheets...');
                    const response = await fetch(GOOGLE_SHEET_URL);
                    const csvText = await response.text();
                    
                    console.log('üìÑ CSV received, length:', csvText.length);
                    
                    const parsed = Papa.parse(csvText, {
                        header: true,
                        dynamicTyping: false, // Keep as strings to handle better
                        skipEmptyLines: true,
                        transformHeader: (header) => header.trim().toLowerCase()
                    });

                    console.log('‚úÖ Parsed:', parsed.data.length, 'rows');
                    console.log('üìã Headers detected:', Object.keys(parsed.data[0] || {}));
                    console.log('üîç First 3 rows:', parsed.data.slice(0, 3));

                    this.CONFIG = FALLBACK_CONFIG;
                    
                    // Map all rows to bands
                    this.allBands = parsed.data
                        .map(row => {
                            const name = row.name || row.artiest || '';
                            const priceStr = row.price || row.prijs || row['volledige prijs'] || '0';
                            const price = parseFloat(String(priceStr).replace(/[^0-9.-]/g, '')) || 0;
                            const category = row.category || row.categorie || '';
                            const info = row.info || row['extra info'] || '';
                            const viableStr = String(row.viable || row.kanshebber || 'true').trim().toLowerCase();
                            const viable = viableStr === 'true' || viableStr === '1' || viableStr === 'yes' || viableStr === 'ja' || viableStr === 'waar' || viableStr === 'x';
                            
                            return { name, price, category, info, viable };
                        })
                        .filter(band => {
                            // Filter out empty rows and header remnants
                            return band.name && 
                                   band.name.length > 0 &&
                                   band.name.toLowerCase() !== 'name' && 
                                   band.name.toLowerCase() !== 'artiest';
                        });

                    console.log('üé∏ Total bands loaded:', this.allBands.length);
                    console.log('‚úÖ Kanshebbers:', this.allBands.filter(b => b.viable).length);
                    console.log('‚ùå Niet voor RoZa:', this.allBands.filter(b => !b.viable).length);
                    console.log('üìä All bands:', this.allBands.map(b => `${b.name} (${b.viable ? 'JA' : 'NEE'})`).join(', '));

                } catch (error) {
                    console.error('‚ùå Error loading Google Sheets:', error);
                    alert(`Fout bij laden van Google Sheets: ${error.message}\n\nControleer of de URL klopt en de sheet publiek is.`);
                    this.allBands = [];
                }
            }

            showLoginPrompt() {
                const app = document.getElementById('app');
                app.innerHTML = `
                    <div class="min-h-screen flex items-center justify-center roza-bg">
                        <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-md w-full">
                            <h1 class="text-5xl font-bold mb-3 text-center roza-title">
                                Hey RoZa,<br>you're in!
                            </h1>
                            <p class="text-gray-600 text-center mb-8 text-lg">Line-up Planner</p>
                            <div class="mb-6">
                                <label class="block text-sm font-bold text-gray-700 mb-3">
                                    Jouw naam:
                                </label>
                                <input 
                                    type="text" 
                                    id="username"
                                    class="w-full px-5 py-4 border-3 border-gray-300 rounded-2xl focus:border-blue-500 focus:outline-none text-lg"
                                    placeholder="Bijv. Frederik"
                                >
                            </div>
                            <button 
                                onclick="app.login()"
                                class="w-full bg-[#1a2238] text-white py-4 rounded-2xl font-bold hover:bg-[#2a3248] transition text-lg"
                            >
                                Start Plannen üéµ
                            </button>
                        </div>
                    </div>
                `;
            }

            async login() {
                const username = document.getElementById('username').value.trim();
                if (username) {
                    this.currentUser = username;
                    localStorage.setItem('roza_user', username);
                    this.showLoadingScreen();
                    await this.loadDataFromGoogleSheets();
                    this.scenarios = this.loadScenarios();
                    this.activeScenarioId = parseInt(localStorage.getItem('roza_active_scenario')) || 1;
                    this.isLoading = false;
                    this.render();
                }
            }

            logout() {
                if (confirm('Weet je zeker dat je wilt uitloggen?')) {
                    this.currentUser = null;
                    localStorage.removeItem('roza_user');
                    this.showLoginPrompt();
                }
            }

            async resetAllData() {
                if (confirm('‚ö†Ô∏è WAARSCHUWING: Dit verwijdert ALLE opgeslagen scenarios en herlaadt de data vanaf Google Sheets.\n\nWeet je zeker dat je door wilt gaan?')) {
                    localStorage.removeItem('roza_scenarios');
                    localStorage.removeItem('roza_active_scenario');
                    
                    this.showLoadingScreen();
                    await this.loadDataFromGoogleSheets();
                    this.scenarios = this.loadScenarios();
                    this.activeScenarioId = 1;
                    this.saveScenarios();
                    this.isLoading = false;
                    this.render();
                    
                    alert(`‚úÖ Reset complete! ${this.allBands.length} bands geladen.`);
                }
            }

            loadScenarios() {
                const saved = localStorage.getItem('roza_scenarios');
                if (saved) {
                    try {
                        const scenarios = JSON.parse(saved);
                        
                        // Update with new data from Google Sheets
                        return scenarios.map(scenario => {
                            const usedBandNames = new Set([
                                ...scenario.mainstage.map(b => b.name),
                                ...scenario.kerk.map(b => b.name),
                                ...scenario.available.map(b => b.name)
                            ]);
                            
                            const newBands = this.allBands.filter(band => !usedBandNames.has(band.name));
                            
                            return {
                                ...scenario,
                                mainstage: scenario.mainstage.map(band => {
                                    const updated = this.allBands.find(b => b.name === band.name);
                                    return updated || band;
                                }),
                                kerk: scenario.kerk.map(band => {
                                    const updated = this.allBands.find(b => b.name === band.name);
                                    return updated || band;
                                }),
                                available: [
                                    ...scenario.available.map(band => {
                                        const updated = this.allBands.find(b => b.name === band.name);
                                        return updated || band;
                                    }),
                                    ...newBands
                                ]
                            };
                        });
                    } catch (e) {
                        console.error('Error loading scenarios:', e);
                    }
                }
                
                // Create new scenario
                const transistor = this.allBands.find(b => b.name === "Transistor");
                const komisar = this.allBands.find(b => b.name === "Komisar");
                const woodsmith = this.allBands.find(b => b.name === "Woodsmith Jr.");
                
                const initialMainstage = [transistor, komisar].filter(Boolean);
                const initialKerk = [woodsmith].filter(Boolean);
                const initialAvailable = this.allBands.filter(b => 
                    b.name !== "Transistor" && 
                    b.name !== "Komisar" && 
                    b.name !== "Woodsmith Jr."
                );

                return [{
                    id: 1,
                    name: "Versie 1",
                    createdBy: this.currentUser,
                    createdAt: new Date().toISOString(),
                    mainstage: initialMainstage,
                    kerk: initialKerk,
                    available: initialAvailable
                }];
            }

            saveScenarios() {
                localStorage.setItem('roza_scenarios', JSON.stringify(this.scenarios));
                localStorage.setItem('roza_active_scenario', this.activeScenarioId);
            }

            getActiveScenario() {
                return this.scenarios.find(s => s.id === this.activeScenarioId);
            }

            addScenario() {
                const newId = Math.max(...this.scenarios.map(s => s.id)) + 1;
                
                const transistor = this.allBands.find(b => b.name === "Transistor");
                const komisar = this.allBands.find(b => b.name === "Komisar");
                const woodsmith = this.allBands.find(b => b.name === "Woodsmith Jr.");
                
                const initialMainstage = [transistor, komisar].filter(Boolean);
                const initialKerk = [woodsmith].filter(Boolean);
                const initialAvailable = this.allBands.filter(b => 
                    b.name !== "Transistor" && 
                    b.name !== "Komisar" && 
                    b.name !== "Woodsmith Jr."
                );
                
                this.scenarios.push({
                    id: newId,
                    name: `Versie ${newId}`,
                    createdBy: this.currentUser,
                    createdAt: new Date().toISOString(),
                    mainstage: initialMainstage,
                    kerk: initialKerk,
                    available: initialAvailable
                });
                this.activeScenarioId = newId;
                this.saveScenarios();
                this.render();
            }

            duplicateScenario(id) {
                const scenario = this.scenarios.find(s => s.id === id);
                const newId = Math.max(...this.scenarios.map(s => s.id)) + 1;
                this.scenarios.push({
                    ...scenario,
                    id: newId,
                    name: `${scenario.name} (kopie)`,
                    createdBy: this.currentUser,
                    createdAt: new Date().toISOString(),
                    mainstage: [...scenario.mainstage],
                    kerk: [...scenario.kerk],
                    available: [...scenario.available]
                });
                this.activeScenarioId = newId;
                this.saveScenarios();
                this.render();
            }

            deleteScenario(id) {
                if (this.scenarios.length === 1) {
                    alert('Je moet minstens 1 versie behouden!');
                    return;
                }
                if (confirm('Weet je zeker dat je deze versie wilt verwijderen?')) {
                    this.scenarios = this.scenarios.filter(s => s.id !== id);
                    if (this.activeScenarioId === id) {
                        this.activeScenarioId = this.scenarios[0].id;
                    }
                    this.saveScenarios();
                    this.render();
                }
            }

            renameScenario(id, newName) {
                const scenario = this.scenarios.find(s => s.id === id);
                if (scenario && newName.trim()) {
                    scenario.name = newName.trim();
                    this.saveScenarios();
                }
                this.editingScenarioId = null;
                this.render();
            }

            handleDrop(targetZone, targetIndex = null) {
                if (!this.draggedBand) return;

                const scenario = this.getActiveScenario();
                let newMainstage = [...scenario.mainstage];
                let newKerk = [...scenario.kerk];
                let newAvailable = [...scenario.available];

                if (this.dragSource === 'available') {
                    newAvailable = newAvailable.filter(b => b.name !== this.draggedBand.name);
                } else if (this.dragSource === 'mainstage') {
                    newMainstage = newMainstage.filter(b => b.name !== this.draggedBand.name);
                } else if (this.dragSource === 'kerk') {
                    newKerk = newKerk.filter(b => b.name !== this.draggedBand.name);
                }

                if (targetZone === 'mainstage') {
                    if (targetIndex !== null) {
                        newMainstage.splice(targetIndex, 0, this.draggedBand);
                    } else {
                        newMainstage.push(this.draggedBand);
                    }
                } else if (targetZone === 'kerk') {
                    if (targetIndex !== null) {
                        newKerk.splice(targetIndex, 0, this.draggedBand);
                    } else {
                        newKerk.push(this.draggedBand);
                    }
                } else if (targetZone === 'available') {
                    newAvailable.push(this.draggedBand);
                }

                scenario.mainstage = newMainstage;
                scenario.kerk = newKerk;
                scenario.available = newAvailable;

                this.draggedBand = null;
                this.dragSource = null;
                this.saveScenarios();
                this.render();
            }

            // Touch event handlers for mobile drag & drop
            handleTouchStart(e, band, source) {
                const touch = e.touches[0];
                this.touchStartX = touch.clientX;
                this.touchStartY = touch.clientY;
                this.touchStartTime = Date.now();
                this.isDragging = false;
                this.draggedBand = band;
                this.dragSource = source;
                this.draggedElement = e.currentTarget;
                this.scrollInterval = null;
                
                // Don't prevent default - allow tap/scroll to work initially
            }

            handleTouchMove(e) {
                if (!this.draggedElement) return;
                
                const touch = e.touches[0];
                const deltaX = touch.clientX - this.touchStartX;
                const deltaY = touch.clientY - this.touchStartY;
                const absDeltaX = Math.abs(deltaX);
                const absDeltaY = Math.abs(deltaY);
                const deltaTime = Date.now() - this.touchStartTime;
                
                // Detect horizontal swipe for quick zone switch
                if (!this.isDragging && absDeltaX > 80 && absDeltaX > absDeltaY * 2 && deltaTime < 300) {
                    e.preventDefault();
                    this.handleQuickSwipe(deltaX > 0 ? 'right' : 'left');
                    this.cleanupDrag();
                    this.draggedElement = null;
                    return;
                }
                
                // Start dragging if moved >15px and held >150ms
                if (!this.isDragging && (absDeltaX > 15 || absDeltaY > 15) && deltaTime > 150) {
                    this.isDragging = true;
                    e.preventDefault();
                    
                    // Hide original element
                    this.draggedElement.style.opacity = '0.3';
                    
                    // Create dragging clone that follows finger
                    this.createDragClone(touch.clientX, touch.clientY);
                    
                    // Create placeholder to show where it will drop
                    this.createPlaceholder();
                }
                
                if (this.isDragging) {
                    e.preventDefault();
                    
                    // Update clone position
                    this.updateDragClone(touch.clientX, touch.clientY);
                    
                    // Handle auto-scroll with better detection
                    this.handleAutoScroll(touch.clientX, touch.clientY);
                    
                    // Update placeholder position
                    this.updatePlaceholder(touch.clientX, touch.clientY);
                }
            }

            handleQuickSwipe(direction) {
                if (!this.draggedBand || !this.dragSource) return;
                
                const zoneOrder = ['available', 'mainstage', 'kerk'];
                const currentIndex = zoneOrder.indexOf(this.dragSource);
                
                let targetZone;
                if (direction === 'right') {
                    // Swipe right: available ‚Üí mainstage ‚Üí kerk
                    targetZone = zoneOrder[Math.min(currentIndex + 1, zoneOrder.length - 1)];
                } else {
                    // Swipe left: kerk ‚Üí mainstage ‚Üí available
                    targetZone = zoneOrder[Math.max(currentIndex - 1, 0)];
                }
                
                // Don't move if already in target zone
                if (targetZone === this.dragSource) {
                    this.showSwipeFeedback('‚ùå Al in deze zone');
                    return;
                }
                
                // Show visual feedback
                const zoneNames = {
                    'mainstage': 'üé∏ Mainstage',
                    'kerk': '‚õ™ Kerk',
                    'available': 'üí∞ Beschikbaar'
                };
                this.showSwipeFeedback(`‚Üí ${zoneNames[targetZone]}`);
                
                // Execute the move
                this.handleDropAtPosition(targetZone, -1); // -1 means append to end
            }

            showSwipeFeedback(message) {
                const feedback = document.createElement('div');
                feedback.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: #1a2238;
                    color: white;
                    padding: 20px 40px;
                    border-radius: 20px;
                    font-weight: bold;
                    font-size: 18px;
                    z-index: 10001;
                    box-shadow: 0 10px 40px rgba(0,0,0,0.4);
                    animation: swipeFeedback 0.5s ease-out;
                `;
                feedback.textContent = message;
                document.body.appendChild(feedback);
                
                setTimeout(() => feedback.remove(), 500);
            }

            handleTouchEnd(e) {
                if (this.isDragging) {
                    e.preventDefault();
                    
                    // Stop auto-scroll
                    if (this.scrollInterval) {
                        clearInterval(this.scrollInterval);
                        this.scrollInterval = null;
                    }
                    
                    // Get drop position from placeholder
                    if (this.placeholder && this.placeholder.parentElement) {
                        const dropZone = this.placeholder.closest('[data-drop-zone]');
                        const targetZone = dropZone?.getAttribute('data-drop-zone');
                        
                        if (targetZone) {
                            // Find index where placeholder is
                            const children = Array.from(dropZone.children).filter(el => 
                                el.classList.contains('band-card') || el === this.placeholder
                            );
                            const targetIndex = children.indexOf(this.placeholder);
                            
                            this.handleDropAtPosition(targetZone, targetIndex);
                        }
                    }
                    
                    // Cleanup
                    this.cleanupDrag();
                }
                
                this.isDragging = false;
                this.draggedElement = null;
                this.draggedBand = null;
                this.dragSource = null;
            }

            createDragClone(x, y) {
                const clone = this.draggedElement.cloneNode(true);
                clone.id = 'drag-clone';
                clone.style.cssText = `
                    position: fixed;
                    top: ${y - 40}px;
                    left: ${x - 150}px;
                    width: 300px;
                    max-width: 90vw;
                    pointer-events: none;
                    z-index: 10000;
                    opacity: 0.95;
                    transform: scale(1.05) rotate(2deg);
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    transition: none;
                `;
                document.body.appendChild(clone);
            }

            updateDragClone(x, y) {
                const clone = document.getElementById('drag-clone');
                if (clone) {
                    clone.style.top = `${y - 40}px`;
                    clone.style.left = `${x - 150}px`;
                }
            }

            createPlaceholder() {
                const placeholder = document.createElement('div');
                placeholder.id = 'drag-placeholder';
                placeholder.className = 'band-card';
                placeholder.style.cssText = `
                    height: ${this.draggedElement.offsetHeight}px;
                    background: rgba(26, 34, 56, 0.1);
                    border: 3px dashed #1a2238;
                    border-radius: 12px;
                    margin: 8px 0;
                `;
                
                // Insert placeholder at original position
                this.draggedElement.parentElement.insertBefore(placeholder, this.draggedElement.nextSibling);
                this.placeholder = placeholder;
            }

            updatePlaceholder(x, y) {
                const elementAtPoint = document.elementFromPoint(x, y);
                if (!elementAtPoint) return;
                
                const dropZone = elementAtPoint.closest('[data-drop-zone]');
                if (!dropZone) return;
                
                // Find closest band card
                const bandCard = elementAtPoint.closest('.band-card:not(#drag-placeholder)');
                
                if (bandCard && this.placeholder) {
                    const rect = bandCard.getBoundingClientRect();
                    const midpoint = rect.top + rect.height / 2;
                    
                    // Insert before or after based on mouse position
                    if (y < midpoint) {
                        bandCard.parentElement.insertBefore(this.placeholder, bandCard);
                    } else {
                        bandCard.parentElement.insertBefore(this.placeholder, bandCard.nextSibling);
                    }
                } else if (dropZone && this.placeholder) {
                    // If hovering over empty drop zone, append to it
                    const firstCard = dropZone.querySelector('.band-card:not(#drag-placeholder)');
                    if (!firstCard && this.placeholder.parentElement !== dropZone) {
                        dropZone.appendChild(this.placeholder);
                    }
                }
            }

            handleAutoScroll(touchX, touchY) {
                const scrollEdgeThreshold = 80; // pixels from edge
                const scrollSpeed = 15; // pixels per frame
                const scrollSpeedFast = 25; // when very close to edge
                
                // Clear existing interval
                if (this.scrollInterval) {
                    clearInterval(this.scrollInterval);
                    this.scrollInterval = null;
                }
                
                const viewportHeight = window.innerHeight;
                const viewportWidth = window.innerWidth;
                const distanceFromTop = touchY;
                const distanceFromBottom = viewportHeight - touchY;
                const distanceFromLeft = touchX;
                const distanceFromRight = viewportWidth - touchX;
                
                let scrollX = 0;
                let scrollY = 0;
                
                // Vertical scrolling
                if (distanceFromTop < scrollEdgeThreshold) {
                    // Scroll up - faster when closer to edge
                    const intensity = 1 - (distanceFromTop / scrollEdgeThreshold);
                    scrollY = -(intensity > 0.5 ? scrollSpeedFast : scrollSpeed);
                } else if (distanceFromBottom < scrollEdgeThreshold) {
                    // Scroll down - faster when closer to edge
                    const intensity = 1 - (distanceFromBottom / scrollEdgeThreshold);
                    scrollY = intensity > 0.5 ? scrollSpeedFast : scrollSpeed;
                }
                
                // Horizontal scrolling (for wide screens or horizontal overflow)
                if (distanceFromLeft < scrollEdgeThreshold) {
                    const intensity = 1 - (distanceFromLeft / scrollEdgeThreshold);
                    scrollX = -(intensity > 0.5 ? scrollSpeedFast : scrollSpeed);
                } else if (distanceFromRight < scrollEdgeThreshold) {
                    const intensity = 1 - (distanceFromRight / scrollEdgeThreshold);
                    scrollX = intensity > 0.5 ? scrollSpeedFast : scrollSpeed;
                }
                
                // Start scrolling if needed
                if (scrollX !== 0 || scrollY !== 0) {
                    this.scrollInterval = setInterval(() => {
                        window.scrollBy(scrollX, scrollY);
                        
                        // Also update clone position during scroll to keep it at finger position
                        const clone = document.getElementById('drag-clone');
                        if (clone && this.isDragging) {
                            const currentTop = parseFloat(clone.style.top);
                            const currentLeft = parseFloat(clone.style.left);
                            clone.style.top = `${currentTop + scrollY}px`;
                            clone.style.left = `${currentLeft + scrollX}px`;
                        }
                    }, 16); // ~60fps
                }
            }

            handleDropAtPosition(targetZone, targetIndex) {
                const scenario = this.getActiveScenario();
                let newMainstage = [...scenario.mainstage];
                let newKerk = [...scenario.kerk];
                let newAvailable = [...scenario.available];

                // Remove from source
                if (this.dragSource === 'available') {
                    newAvailable = newAvailable.filter(b => b.name !== this.draggedBand.name);
                } else if (this.dragSource === 'mainstage') {
                    newMainstage = newMainstage.filter(b => b.name !== this.draggedBand.name);
                } else if (this.dragSource === 'kerk') {
                    newKerk = newKerk.filter(b => b.name !== this.draggedBand.name);
                }

                // Add to target at specific position (-1 means append to end)
                if (targetZone === 'mainstage') {
                    if (targetIndex === -1) {
                        newMainstage.push(this.draggedBand);
                    } else {
                        newMainstage.splice(targetIndex, 0, this.draggedBand);
                    }
                } else if (targetZone === 'kerk') {
                    if (targetIndex === -1) {
                        newKerk.push(this.draggedBand);
                    } else {
                        newKerk.splice(targetIndex, 0, this.draggedBand);
                    }
                } else if (targetZone === 'available') {
                    if (targetIndex === -1) {
                        newAvailable.push(this.draggedBand);
                    } else {
                        newAvailable.splice(targetIndex, 0, this.draggedBand);
                    }
                }

                scenario.mainstage = newMainstage;
                scenario.kerk = newKerk;
                scenario.available = newAvailable;

                this.saveScenarios();
                this.render();
            }

            cleanupDrag() {
                // Remove clone
                const clone = document.getElementById('drag-clone');
                if (clone) clone.remove();
                
                // Remove placeholder
                if (this.placeholder) {
                    this.placeholder.remove();
                    this.placeholder = null;
                }
                
                // Reset original element
                if (this.draggedElement) {
                    this.draggedElement.style.opacity = '1';
                }
            }

            async generatePoster() {
                this.showPosterView = true;
                this.render();
                
                setTimeout(async () => {
                    const posterElement = document.getElementById('poster');
                    const canvas = await html2canvas(posterElement, {
                        scale: 2,
                        backgroundColor: null
                    });
                    
                    canvas.toBlob((blob) => {
                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        const scenario = this.getActiveScenario();
                        link.href = url;
                        link.download = `roza-lineup-${scenario.name}.png`;
                        link.click();
                        
                        this.showPosterView = false;
                        this.render();
                    });
                }, 500);
            }

            renderPoster() {
                const scenario = this.getActiveScenario();
                const mainstageTotal = scenario.mainstage.reduce((s, b) => s + b.price, 0);
                const kerkTotal = scenario.kerk.reduce((s, b) => s + b.price, 0);

                return `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4">
                        <div class="bg-white rounded-3xl p-4 sm:p-8 max-w-3xl w-full max-h-[95vh] overflow-y-auto">
                            <div id="poster" class="relative rounded-3xl overflow-hidden mx-auto" style="width: min(700px, 100%); height: auto; aspect-ratio: 7/9; background-color: #FFB7B2;">
                                <div style="position: absolute; width: 200%; height: 200%; top: -50%; left: -50%; transform: rotate(45deg); z-index: 0;">
                                    ${Array(12).fill('').map((_, i) => `<div style="background: ${i % 3 === 0 ? '#FF9AA2' : i % 3 === 1 ? '#FFB7B2' : '#FFDAC1'}; height: 100px;"></div>`).join('')}
                                </div>
                                
                                <div style="position: relative; z-index: 10; padding: 2rem; height: 100%; display: flex; flex-direction: column;">
                                    <h1 style="font-family: 'Fredoka', sans-serif; font-size: clamp(2.5rem, 8vw, 4.5rem); font-weight: 700; color: #1a2238; text-align: center; margin: 0 0 1.5rem 0; line-height: 1.1;">
                                        Line-up<br>RoZa 2026
                                    </h1>
                                    
                                    <div style="background: #FFFFFF; border-radius: 1rem; padding: 1rem; margin: 0 auto 2rem auto; max-width: 400px; width: 100%;">
                                        <p style="font-family: 'Fredoka', sans-serif; font-size: clamp(1.25rem, 4vw, 2rem); font-weight: 700; color: #1a2238; text-align: center; margin: 0 0 0.5rem 0;">
                                            ${this.CONFIG.datum}
                                        </p>
                                        <p style="font-family: 'Fredoka', sans-serif; font-size: clamp(1rem, 3vw, 1.25rem); font-weight: 400; color: #1a2238; text-align: center; margin: 0;">
                                            ${this.CONFIG.locatie}
                                        </p>
                                    </div>

                                    <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem; flex: 1;">
                                        <div style="flex: 1; background: #1a2238; padding: 1rem; border-radius: 1rem; display: flex; flex-direction: column;">
                                            <h2 style="font-family: 'Fredoka', sans-serif; font-size: clamp(1rem, 3vw, 1.5rem); font-weight: 700; color: #FFB7B2; border-bottom: 2px solid #FFB7B2; padding-bottom: 0.5rem; margin: 0 0 0.75rem 0;">
                                                üé∏ MAINSTAGE
                                            </h2>
                                            ${scenario.mainstage.map((band, idx) => `
                                                <p style="font-family: 'Fredoka', sans-serif; color: #FFFFFF; margin: 0 0 0.4rem 0; font-size: clamp(0.75rem, 2.5vw, ${idx === scenario.mainstage.length - 1 ? '1.25rem' : '1rem'}); font-weight: ${idx === scenario.mainstage.length - 1 ? '700' : '400'}; ${idx === scenario.mainstage.length - 1 ? 'margin-top: 0.75rem;' : ''}">
                                                    ${band.name}
                                                </p>
                                            `).join('')}
                                        </div>

                                        <div style="flex: 1; background: #1a2238; padding: 1rem; border-radius: 1rem; display: flex; flex-direction: column;">
                                            <h2 style="font-family: 'Fredoka', sans-serif; font-size: clamp(1rem, 3vw, 1.5rem); font-weight: 700; color: #FFB7B2; border-bottom: 2px solid #FFB7B2; padding-bottom: 0.5rem; margin: 0 0 0.75rem 0;">
                                                ‚õ™ KERK
                                            </h2>
                                            ${scenario.kerk.map(band => `
                                                <p style="font-family: 'Fredoka', sans-serif; font-size: clamp(0.75rem, 2.5vw, 1rem); font-weight: 400; color: #FFFFFF; margin: 0 0 0.4rem 0;">
                                                    ${band.name}
                                                </p>
                                            `).join('')}
                                        </div>
                                    </div>

                                    <div style="background: #FFFFFF; border-radius: 1rem; padding: 0.75rem;">
                                        <p style="font-family: 'Fredoka', sans-serif; font-size: clamp(0.75rem, 2vw, 0.875rem); font-weight: 600; color: #1a2238; text-align: center; margin: 0;">
                                            ${scenario.name} ‚Ä¢ ‚Ç¨${mainstageTotal + kerkTotal} budget
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 sm:mt-6 text-center">
                                <button onclick="app.showPosterView = false; app.render()" 
                                    class="bg-[#1a2238] text-white px-6 sm:px-8 py-2 sm:py-3 rounded-2xl hover:bg-[#2a3248] font-bold text-base sm:text-lg">
                                    Sluiten
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            render() {
                if (!this.currentUser || this.isLoading) return;

                const scenario = this.getActiveScenario();
                const mainstageTotal = scenario.mainstage.reduce((s, b) => s + b.price, 0);
                const kerkTotal = scenario.kerk.reduce((s, b) => s + b.price, 0);
                const totalSpent = mainstageTotal + kerkTotal;
                const remaining = this.CONFIG.totaleBudget - totalSpent;

                const kanshebbers = scenario.available.filter(b => b.viable).sort((a, b) => b.price - a.price);
                const nietVoorRoza = scenario.available.filter(b => !b.viable).sort((a, b) => b.price - a.price);

                const app = document.getElementById('app');
                app.innerHTML = `
                    ${this.showPosterView ? this.renderPoster() : ''}
                    
                    <div class="min-h-screen roza-bg p-3 sm:p-6">
                        <div class="max-w-7xl mx-auto">
                            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 sm:mb-6 gap-4">
                                <div>
                                    <h1 class="text-3xl sm:text-5xl font-bold roza-title">Hey RoZa, you're in!</h1>
                                    <p class="text-[#1a2238] text-sm sm:text-lg font-semibold opacity-80">${this.CONFIG.datum} ‚Ä¢ ${this.CONFIG.locatie}</p>
                                </div>
                                <div class="flex flex-wrap items-center gap-2 sm:gap-4 w-full sm:w-auto">
                                    <button onclick="app.resetAllData()" 
                                        class="bg-red-600 text-white px-3 sm:px-5 py-2 sm:py-3 rounded-2xl hover:bg-red-700 flex items-center gap-2 font-bold text-sm sm:text-base"
                                        title="Reset alle data en herlaad vanaf Google Sheets">
                                        üîÑ <span class="hidden sm:inline">Reset</span>
                                    </button>
                                    <button onclick="app.generatePoster()" 
                                        class="bg-[#1a2238] text-white px-3 sm:px-5 py-2 sm:py-3 rounded-2xl hover:bg-[#2a3248] flex items-center gap-2 font-bold text-sm sm:text-base">
                                        üé® <span class="hidden sm:inline">Poster</span>
                                    </button>
                                    <div class="text-right bg-white rounded-2xl px-3 sm:px-4 py-2 text-sm sm:text-base">
                                        <div class="text-xs sm:text-sm text-gray-600">Ingelogd als</div>
                                        <div class="font-bold roza-title">${this.currentUser}</div>
                                        <button onclick="app.logout()" class="text-xs text-red-600 hover:underline font-semibold">
                                            Uitloggen
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-2xl shadow-lg p-3 sm:p-4 mb-4 sm:mb-6">
                                <div class="flex items-center gap-2 overflow-x-auto pb-2 -mx-2 px-2 sm:mx-0 sm:px-0">
                                    ${this.scenarios.map(s => `
                                        <div class="flex items-center gap-2 px-3 sm:px-5 py-2 sm:py-3 rounded-2xl cursor-pointer transition-all whitespace-nowrap text-sm sm:text-base ${
                                            this.activeScenarioId === s.id
                                                ? 'bg-[#1a2238] text-white'
                                                : 'bg-[#FFE5E5] text-[#1a2238] hover:bg-[#FFD5D5]'
                                        }">
                                            ${this.editingScenarioId === s.id ? `
                                                <input 
                                                    type="text" 
                                                    value="${this.editName}"
                                                    onchange="app.editName = this.value"
                                                    onblur="app.renameScenario(${s.id}, this.value)"
                                                    onkeydown="if(event.key==='Enter') app.renameScenario(${s.id}, this.value); if(event.key==='Escape') { app.editingScenarioId=null; app.render(); }"
                                                    class="bg-white text-[#1a2238] px-2 sm:px-3 py-1 sm:py-2 rounded-xl w-24 sm:w-32 font-bold text-sm sm:text-base"
                                                    autofocus
                                                >
                                            ` : `
                                                <span onclick="app.activeScenarioId = ${s.id}; app.saveScenarios(); app.render()" class="font-bold">
                                                    ${s.name}
                                                </span>
                                            `}
                                            
                                            ${this.activeScenarioId === s.id ? `
                                                <div class="flex items-center gap-1">
                                                    <button onclick="app.editingScenarioId = ${s.id}; app.editName = '${s.name}'; app.render()" 
                                                        class="p-1 hover:bg-[#2a3248] rounded-lg text-sm sm:text-base" title="Hernoemen">
                                                        ‚úèÔ∏è
                                                    </button>
                                                    <button onclick="app.duplicateScenario(${s.id})" 
                                                        class="p-1 hover:bg-[#2a3248] rounded-lg text-sm sm:text-base" title="Dupliceren">
                                                        üìã
                                                    </button>
                                                    ${this.scenarios.length > 1 ? `
                                                        <button onclick="app.deleteScenario(${s.id})" 
                                                            class="p-1 hover:bg-red-600 rounded-lg text-sm sm:text-base" title="Verwijderen">
                                                            üóëÔ∏è
                                                        </button>
                                                    ` : ''}
                                                </div>
                                            ` : ''}
                                        </div>
                                    `).join('')}
                                    <button onclick="app.addScenario()" 
                                        class="flex items-center gap-2 px-3 sm:px-5 py-2 sm:py-3 bg-[#1a2238] text-white rounded-2xl hover:bg-[#2a3248] transition-all whitespace-nowrap font-bold text-sm sm:text-base">
                                        ‚ûï <span class="hidden sm:inline">Nieuw</span>
                                    </button>
                                </div>
                            </div>

                            <div class="bg-white rounded-2xl shadow-lg p-4 sm:p-6 mb-4 sm:mb-6">
                                <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4">
                                    <div class="text-center bg-[#FFE5E5] rounded-2xl p-3 sm:p-4">
                                        <div class="text-xs sm:text-sm text-[#1a2238] mb-1 font-semibold">Totaal Budget</div>
                                        <div class="text-xl sm:text-3xl font-bold roza-title">‚Ç¨${this.CONFIG.totaleBudget}</div>
                                    </div>
                                    <div class="text-center bg-[#E3F2FD] rounded-2xl p-3 sm:p-4">
                                        <div class="text-xs sm:text-sm text-[#1a2238] mb-1 font-semibold">Mainstage</div>
                                        <div class="text-xl sm:text-3xl font-bold text-blue-600">‚Ç¨${mainstageTotal}</div>
                                        <div class="text-xs text-gray-600 font-semibold">${scenario.mainstage.length} acts</div>
                                    </div>
                                    <div class="text-center bg-[#F3E5F5] rounded-2xl p-3 sm:p-4">
                                        <div class="text-xs sm:text-sm text-[#1a2238] mb-1 font-semibold">Kerk</div>
                                        <div class="text-xl sm:text-3xl font-bold text-purple-600">‚Ç¨${kerkTotal}</div>
                                        <div class="text-xs text-gray-600 font-semibold">${scenario.kerk.length} acts</div>
                                    </div>
                                    <div class="text-center ${remaining >= 0 ? 'bg-[#E8F5E9]' : 'bg-[#FFEBEE]'} rounded-2xl p-3 sm:p-4">
                                        <div class="text-xs sm:text-sm text-[#1a2238] mb-1 font-semibold">Resterend</div>
                                        <div class="text-xl sm:text-3xl font-bold ${remaining >= 0 ? 'text-green-600' : 'text-red-600'}">
                                            ‚Ç¨${remaining}
                                        </div>
                                        <div class="text-xs text-gray-600 font-semibold">
                                            ${remaining >= 0 ? '‚úÖ Binnen' : '‚ùå Over!'}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
                                <div class="bg-white rounded-2xl shadow-lg p-4 sm:p-6">
                                    <h2 class="text-2xl sm:text-3xl font-bold roza-title mb-3 sm:mb-4 flex items-center gap-2">
                                        üé∏ Mainstage
                                    </h2>
                                    <div class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4 font-semibold">
                                        ${scenario.mainstage.length} acts ‚Ä¢ ‚Ç¨${mainstageTotal}
                                    </div>
                                    <div 
                                        ondragover="event.preventDefault()"
                                        ondrop="app.handleDrop('mainstage')"
                                        data-drop-zone="mainstage"
                                        class="space-y-2 sm:space-y-3 min-h-[200px] p-3 sm:p-4 bg-blue-50 rounded-2xl border-2 border-dashed border-blue-300">
                                        ${scenario.mainstage.map((band, idx) => `
                                            <div 
                                                draggable="true"
                                                ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'mainstage'"
                                                ontouchstart="app.handleTouchStart(event, ${JSON.stringify(band).replace(/"/g, '&quot;')}, 'mainstage')"
                                                ontouchmove="app.handleTouchMove(event)"
                                                ontouchend="app.handleTouchEnd(event)"
                                                class="band-card bg-white p-3 sm:p-4 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-blue-400 transition-all">
                                                <div class="flex justify-between items-start gap-2">
                                                    <div class="flex-1 min-w-0">
                                                        <div class="font-bold text-[#1a2238] text-sm sm:text-base">${idx + 1}. ${band.name}</div>
                                                        ${band.category ? `<div class="text-xs text-gray-500 mt-1 font-semibold">${band.category}</div>` : ''}
                                                        ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                    </div>
                                                    <div class="text-right flex-shrink-0">
                                                        <div class="font-bold text-sm sm:text-base text-green-600">
                                                            ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                        ${scenario.mainstage.length === 0 ? '<div class="text-center text-gray-400 py-8 text-sm">Sleep bands hierheen</div>' : ''}
                                    </div>
                                </div>

                                <div class="bg-white rounded-2xl shadow-lg p-4 sm:p-6">
                                    <h2 class="text-2xl sm:text-3xl font-bold roza-title mb-3 sm:mb-4 flex items-center gap-2">
                                        ‚õ™ Kerk
                                    </h2>
                                    <div class="text-xs sm:text-sm text-gray-600 mb-3 sm:mb-4 font-semibold">
                                        ${scenario.kerk.length} acts ‚Ä¢ ‚Ç¨${kerkTotal}
                                    </div>
                                    <div 
                                        ondragover="event.preventDefault()"
                                        ondrop="app.handleDrop('kerk')"
                                        data-drop-zone="kerk"
                                        class="space-y-2 sm:space-y-3 min-h-[200px] p-3 sm:p-4 bg-purple-50 rounded-2xl border-2 border-dashed border-purple-300">
                                        ${scenario.kerk.map((band, idx) => `
                                            <div 
                                                draggable="true"
                                                ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'kerk'"
                                                ontouchstart="app.handleTouchStart(event, ${JSON.stringify(band).replace(/"/g, '&quot;')}, 'kerk')"
                                                ontouchmove="app.handleTouchMove(event)"
                                                ontouchend="app.handleTouchEnd(event)"
                                                class="band-card bg-white p-3 sm:p-4 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-purple-400 transition-all">
                                                <div class="flex justify-between items-start gap-2">
                                                    <div class="flex-1 min-w-0">
                                                        <div class="font-bold text-[#1a2238] text-sm sm:text-base">${idx + 1}. ${band.name}</div>
                                                        ${band.category ? `<div class="text-xs text-gray-500 mt-1 font-semibold">${band.category}</div>` : ''}
                                                        ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                    </div>
                                                    <div class="text-right flex-shrink-0">
                                                        <div class="font-bold text-sm sm:text-base text-green-600">
                                                            ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                        ${scenario.kerk.length === 0 ? '<div class="text-center text-gray-400 py-8 text-sm">Sleep bands hierheen</div>' : ''}
                                    </div>
                                </div>

                                <div class="bg-white rounded-2xl shadow-lg p-4 sm:p-6">
                                    <h2 class="text-2xl sm:text-3xl font-bold roza-title mb-3 sm:mb-4 flex items-center gap-2">
                                        üí∞ Beschikbaar
                                    </h2>
                                    
                                    <div class="space-y-4 max-h-[600px] overflow-y-auto">
                                        <div>
                                            <div class="flex items-center gap-2 mb-2 sticky top-0 bg-white py-2 z-10">
                                                <span class="text-yellow-500">‚≠ê</span>
                                                <h3 class="font-bold text-green-700 text-sm">Kanshebbers</h3>
                                                <span class="text-xs text-gray-500 font-semibold">(${kanshebbers.length})</span>
                                            </div>
                                            <div 
                                                ondragover="event.preventDefault()"
                                                ondrop="app.handleDrop('available')"
                                                data-drop-zone="available"
                                                class="space-y-2 p-3 bg-green-50 rounded-2xl">
                                                ${kanshebbers.map(band => `
                                                    <div 
                                                        draggable="true"
                                                        ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'available'"
                                                        ontouchstart="app.handleTouchStart(event, ${JSON.stringify(band).replace(/"/g, '&quot;')}, 'available')"
                                                        ontouchmove="app.handleTouchMove(event)"
                                                        ontouchend="app.handleTouchEnd(event)"
                                                        class="band-card bg-white p-3 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-green-400 transition-all">
                                                        <div class="flex justify-between items-start gap-2">
                                                            <div class="flex-1 min-w-0">
                                                                <div class="font-bold text-[#1a2238] text-sm">${band.name}</div>
                                                                ${band.category ? `<div class="text-xs text-gray-500 mt-1">${band.category}</div>` : ''}
                                                                ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                            </div>
                                                            <div class="text-right flex-shrink-0">
                                                                <div class="font-bold text-sm text-green-600">
                                                                    ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>

                                        <div>
                                            <div class="flex items-center gap-2 mb-2 sticky top-0 bg-white py-2 z-10">
                                                <span class="text-red-500">‚ùå</span>
                                                <h3 class="font-bold text-red-700 text-sm">Niet voor RoZa 2026</h3>
                                                <span class="text-xs text-gray-500 font-semibold">(${nietVoorRoza.length})</span>
                                            </div>
                                            <div 
                                                ondragover="event.preventDefault()"
                                                ondrop="app.handleDrop('available')"
                                                data-drop-zone="available"
                                                class="space-y-2 p-3 bg-red-50 rounded-2xl">
                                                ${nietVoorRoza.map(band => `
                                                    <div 
                                                        draggable="true"
                                                        ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'available'"
                                                        ontouchstart="app.handleTouchStart(event, ${JSON.stringify(band).replace(/"/g, '&quot;')}, 'available')"
                                                        ontouchmove="app.handleTouchMove(event)"
                                                        ontouchend="app.handleTouchEnd(event)"
                                                        class="band-card bg-white p-3 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-red-400 transition-all">
                                                        <div class="flex justify-between items-start gap-2">
                                                            <div class="flex-1 min-w-0">
                                                                <div class="font-bold text-[#1a2238] text-sm">${band.name}</div>
                                                                ${band.category ? `<div class="text-xs text-gray-500 mt-1">${band.category}</div>` : ''}
                                                                ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                            </div>
                                                            <div class="text-right flex-shrink-0">
                                                                <div class="font-bold text-sm text-green-600">
                                                                    ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        const app = new FestivalApp();
        window.app = app;
    </script>
</body>
</html>
