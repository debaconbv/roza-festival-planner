<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoZa Festival 2026 - Line-up Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Fredoka', sans-serif;
        }
        
        .poster-view {
            background: 
                repeating-linear-gradient(
                    45deg,
                    #FF9AA2,
                    #FFB7B2 50px,
                    #FFDAC1 50px,
                    #FFDAC1 100px,
                    #FFB7B2 100px,
                    #FFB7B2 150px,
                    #FF9AA2 150px,
                    #FF9AA2 200px
                );
            font-family: 'Fredoka', sans-serif;
        }
        
        .roza-title {
            font-family: 'Fredoka', sans-serif;
            font-weight: 700;
            color: #1a2238;
        }
        
        .roza-bg {
            background: linear-gradient(135deg, #FFB7B2 0%, #FF9AA2 50%, #FFDAC1 100%);
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1a2238;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>

    <script>
        // ============================================
        // üéµ CONFIGURATIE - VASTE INSTELLINGEN
        // ============================================
        
        // VERVANG DEZE URL MET JOUW GOOGLE SHEET URL (zie instructies hieronder)
        const GOOGLE_SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQlf_lAOPrCrIq-vQ5To-129nW60GhxMh5w_j4x6uRHQnV8lPXSAxXkgcQjbS8qWlBBBy-DNTVP7l02/pub?gid=0&single=true&output=csv';
        
        // Fallback data als Google Sheet niet beschikbaar is
        const FALLBACK_CONFIG = {
            festivalNaam: "RoZa Festival",
            datum: "12 september 2026",
            locatie: "Zammel, Geel",
            totaleBudget: 10000
        };

        const FALLBACK_BANDS = [
            { name: "Transistor", price: 500, category: "lokaal", info: "nog marge", viable: true },
            { name: "Komisar", price: 500, category: "lokaal", info: "", viable: true },
            { name: "The Yummy Mouths", price: 1020, category: "middenklasse", info: "", viable: true },
            { name: "RHEA", price: 4840, category: "(sub) Headliner", info: "Gaat daarna in pauze!", viable: true },
            { name: "WASTE", price: 1210, category: "(sub) Headliner", info: "Nieuwe plaat 6 maart", viable: true },
            { name: "Woodsmith Jr.", price: 302.5, category: "lokaal", info: "", viable: true },
        ];

        // ============================================
        // üì± APPLICATIE CODE
        // ============================================
        class FestivalApp {
            constructor() {
                this.currentUser = localStorage.getItem('roza_user') || null;
                this.scenarios = [];
                this.activeScenarioId = 1;
                this.showPosterView = false;
                this.draggedBand = null;
                this.dragSource = null;
                this.editingScenarioId = null;
                this.editName = '';
                this.isLoading = true;
                this.CONFIG = null;
                this.allBands = [];
                
                this.init();
            }

            async init() {
                if (!this.currentUser) {
                    this.showLoginPrompt();
                } else {
                    this.showLoadingScreen();
                    await this.loadDataFromGoogleSheets();
                    this.scenarios = this.loadScenarios();
                    this.activeScenarioId = parseInt(localStorage.getItem('roza_active_scenario')) || 1;
                    this.isLoading = false;
                    this.render();
                }
            }

            showLoadingScreen() {
                const app = document.getElementById('app');
                app.innerHTML = `
                    <div class="min-h-screen flex items-center justify-center roza-bg">
                        <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-md w-full text-center">
                            <div class="loading-spinner mx-auto mb-4"></div>
                            <p class="text-xl font-bold roza-title">Bands laden...</p>
                            <p class="text-gray-600 mt-2">Even geduld terwijl we de laatste data ophalen</p>
                        </div>
                    </div>
                `;
            }

            async loadDataFromGoogleSheets() {
                try {
                    // Check if using default placeholder URL
                    if (GOOGLE_SHEET_URL.includes('YOUR_SHEET_ID_HERE')) {
                        console.log('Google Sheet URL not configured, using fallback data');
                        this.CONFIG = FALLBACK_CONFIG;
                        this.allBands = FALLBACK_BANDS;
                        return;
                    }

                    const response = await fetch(GOOGLE_SHEET_URL);
                    const csvText = await response.text();
                    
                    const parsed = Papa.parse(csvText, {
                        header: true,
                        dynamicTyping: true,
                        skipEmptyLines: true
                    });

                    if (parsed.data && parsed.data.length > 0) {
                        // First row might contain config
                        const firstRow = parsed.data[0];
                        
                        if (firstRow.festivalNaam) {
                            // Config row
                            this.CONFIG = {
                                festivalNaam: firstRow.festivalNaam || FALLBACK_CONFIG.festivalNaam,
                                datum: firstRow.datum || FALLBACK_CONFIG.datum,
                                locatie: firstRow.locatie || FALLBACK_CONFIG.locatie,
                                totaleBudget: firstRow.totaleBudget || FALLBACK_CONFIG.totaleBudget
                            };
                            // Rest are bands
                            this.allBands = parsed.data.slice(1).map(row => ({
                                name: row.name || row.Artiest || '',
                                price: parseFloat(row.price || row.Prijs || row.volledige_prijs || 0),
                                category: row.category || row.Categorie || '',
                                info: row.info || row.extra_info || '',
                                viable: row.viable === true || row.viable === 'true' || row.viable === 1 || row.viable === '1'
                            })).filter(band => band.name);
                        } else {
                            // No config row, all bands
                            this.CONFIG = FALLBACK_CONFIG;
                            this.allBands = parsed.data.map(row => ({
                                name: row.name || row.Artiest || '',
                                price: parseFloat(row.price || row.Prijs || row['volledige prijs'] || 0),
                                category: row.category || row.Categorie || '',
                                info: row.info || row['extra info'] || '',
                                viable: row.viable === true || row.viable === 'true' || row.viable === 1 || row.viable === '1'
                            })).filter(band => band.name);
                        }
                    } else {
                        throw new Error('No data found in sheet');
                    }

                    console.log('‚úÖ Data loaded from Google Sheets:', this.allBands.length, 'bands');
                } catch (error) {
                    console.warn('‚ö†Ô∏è Could not load Google Sheet, using fallback data:', error.message);
                    this.CONFIG = FALLBACK_CONFIG;
                    this.allBands = FALLBACK_BANDS;
                }
            }

            showLoginPrompt() {
                const app = document.getElementById('app');
                app.innerHTML = `
                    <div class="min-h-screen flex items-center justify-center roza-bg">
                        <div class="bg-white rounded-3xl shadow-2xl p-10 max-w-md w-full">
                            <h1 class="text-5xl font-bold mb-3 text-center roza-title">
                                Hey RoZa,<br>you're in!
                            </h1>
                            <p class="text-gray-600 text-center mb-8 text-lg">Line-up Planner</p>
                            <div class="mb-6">
                                <label class="block text-sm font-bold text-gray-700 mb-3">
                                    Jouw naam:
                                </label>
                                <input 
                                    type="text" 
                                    id="username"
                                    class="w-full px-5 py-4 border-3 border-gray-300 rounded-2xl focus:border-blue-500 focus:outline-none text-lg"
                                    placeholder="Bijv. Frederik"
                                >
                            </div>
                            <button 
                                onclick="app.login()"
                                class="w-full bg-[#1a2238] text-white py-4 rounded-2xl font-bold hover:bg-[#2a3248] transition text-lg"
                            >
                                Start Plannen üéµ
                            </button>
                        </div>
                    </div>
                `;
            }

            async login() {
                const username = document.getElementById('username').value.trim();
                if (username) {
                    this.currentUser = username;
                    localStorage.setItem('roza_user', username);
                    this.showLoadingScreen();
                    await this.loadDataFromGoogleSheets();
                    this.scenarios = this.loadScenarios();
                    this.activeScenarioId = parseInt(localStorage.getItem('roza_active_scenario')) || 1;
                    this.isLoading = false;
                    this.render();
                }
            }

            logout() {
                if (confirm('Weet je zeker dat je wilt uitloggen?')) {
                    this.currentUser = null;
                    localStorage.removeItem('roza_user');
                    this.showLoginPrompt();
                }
            }

            loadScenarios() {
                const saved = localStorage.getItem('roza_scenarios');
                if (saved) {
                    try {
                        const scenarios = JSON.parse(saved);
                        // Update prices in saved scenarios with current data from Google Sheets
                        return scenarios.map(scenario => {
                            return {
                                ...scenario,
                                mainstage: scenario.mainstage.map(band => {
                                    const updated = this.allBands.find(b => b.name === band.name);
                                    return updated || band;
                                }),
                                kerk: scenario.kerk.map(band => {
                                    const updated = this.allBands.find(b => b.name === band.name);
                                    return updated || band;
                                }),
                                available: scenario.available.map(band => {
                                    const updated = this.allBands.find(b => b.name === band.name);
                                    return updated || band;
                                })
                            };
                        });
                    } catch (e) {
                        console.error('Error loading saved scenarios:', e);
                    }
                }
                
                // Create initial scenario with bands from Google Sheets
                const transistor = this.allBands.find(b => b.name === "Transistor");
                const komisar = this.allBands.find(b => b.name === "Komisar");
                const woodsmith = this.allBands.find(b => b.name === "Woodsmith Jr.");
                
                const initialMainstage = [transistor, komisar].filter(Boolean);
                const initialKerk = [woodsmith].filter(Boolean);
                const initialAvailable = this.allBands.filter(b => 
                    b.name !== "Transistor" && 
                    b.name !== "Komisar" && 
                    b.name !== "Woodsmith Jr."
                );

                return [{
                    id: 1,
                    name: "Versie 1",
                    createdBy: this.currentUser,
                    createdAt: new Date().toISOString(),
                    mainstage: initialMainstage,
                    kerk: initialKerk,
                    available: initialAvailable
                }];
            }

            saveScenarios() {
                localStorage.setItem('roza_scenarios', JSON.stringify(this.scenarios));
                localStorage.setItem('roza_active_scenario', this.activeScenarioId);
            }

            getActiveScenario() {
                return this.scenarios.find(s => s.id === this.activeScenarioId);
            }

            exportScenario(scenarioId) {
                const scenario = this.scenarios.find(s => s.id === scenarioId);
                const dataStr = JSON.stringify(scenario, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `roza-${scenario.name.replace(/\s/g, '-')}.json`;
                link.click();
            }

            importScenario() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = (e) => {
                    const file = e.target.files[0];
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        try {
                            const scenario = JSON.parse(event.target.result);
                            const newId = Math.max(...this.scenarios.map(s => s.id)) + 1;
                            scenario.id = newId;
                            scenario.name = `${scenario.name} (ge√Ømporteerd)`;
                            
                            // Update prices with current data from Google Sheets
                            scenario.mainstage = scenario.mainstage.map(band => {
                                const updated = this.allBands.find(b => b.name === band.name);
                                return updated || band;
                            });
                            scenario.kerk = scenario.kerk.map(band => {
                                const updated = this.allBands.find(b => b.name === band.name);
                                return updated || band;
                            });
                            scenario.available = scenario.available.map(band => {
                                const updated = this.allBands.find(b => b.name === band.name);
                                return updated || band;
                            });
                            
                            this.scenarios.push(scenario);
                            this.activeScenarioId = newId;
                            this.saveScenarios();
                            this.render();
                        } catch (err) {
                            alert('Fout bij importeren: ' + err.message);
                        }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            async generatePoster() {
                this.showPosterView = true;
                this.render();
                
                setTimeout(async () => {
                    const posterElement = document.getElementById('poster');
                    const canvas = await html2canvas(posterElement, {
                        scale: 2,
                        backgroundColor: null
                    });
                    
                    canvas.toBlob((blob) => {
                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        const scenario = this.getActiveScenario();
                        link.href = url;
                        link.download = `roza-lineup-${scenario.name}.png`;
                        link.click();
                        
                        this.showPosterView = false;
                        this.render();
                    });
                }, 500);
            }

            addScenario() {
                const newId = Math.max(...this.scenarios.map(s => s.id)) + 1;
                
                // Gebruik de actuele data uit this.allBands (geladen van Google Sheets)
                const transistor = this.allBands.find(b => b.name === "Transistor");
                const komisar = this.allBands.find(b => b.name === "Komisar");
                const woodsmith = this.allBands.find(b => b.name === "Woodsmith Jr.");
                
                const initialMainstage = [transistor, komisar].filter(Boolean);
                const initialKerk = [woodsmith].filter(Boolean);
                const initialAvailable = this.allBands.filter(b => 
                    b.name !== "Transistor" && 
                    b.name !== "Komisar" && 
                    b.name !== "Woodsmith Jr."
                );
                
                this.scenarios.push({
                    id: newId,
                    name: `Versie ${newId}`,
                    createdBy: this.currentUser,
                    createdAt: new Date().toISOString(),
                    mainstage: initialMainstage,
                    kerk: initialKerk,
                    available: initialAvailable
                });
                this.activeScenarioId = newId;
                this.saveScenarios();
                this.render();
            }

            duplicateScenario(id) {
                const scenario = this.scenarios.find(s => s.id === id);
                const newId = Math.max(...this.scenarios.map(s => s.id)) + 1;
                this.scenarios.push({
                    ...scenario,
                    id: newId,
                    name: `${scenario.name} (kopie)`,
                    createdBy: this.currentUser,
                    createdAt: new Date().toISOString(),
                    mainstage: [...scenario.mainstage],
                    kerk: [...scenario.kerk],
                    available: [...scenario.available]
                });
                this.activeScenarioId = newId;
                this.saveScenarios();
                this.render();
            }

            deleteScenario(id) {
                if (this.scenarios.length === 1) {
                    alert('Je moet minstens 1 versie behouden!');
                    return;
                }
                if (confirm('Weet je zeker dat je deze versie wilt verwijderen?')) {
                    this.scenarios = this.scenarios.filter(s => s.id !== id);
                    if (this.activeScenarioId === id) {
                        this.activeScenarioId = this.scenarios[0].id;
                    }
                    this.saveScenarios();
                    this.render();
                }
            }

            renameScenario(id, newName) {
                const scenario = this.scenarios.find(s => s.id === id);
                if (scenario && newName.trim()) {
                    scenario.name = newName.trim();
                    this.saveScenarios();
                }
                this.editingScenarioId = null;
                this.render();
            }

            handleDrop(targetZone, targetIndex = null) {
                if (!this.draggedBand) return;

                const scenario = this.getActiveScenario();
                let newMainstage = [...scenario.mainstage];
                let newKerk = [...scenario.kerk];
                let newAvailable = [...scenario.available];

                if (this.dragSource === 'available') {
                    newAvailable = newAvailable.filter(b => b.name !== this.draggedBand.name);
                } else if (this.dragSource === 'mainstage') {
                    newMainstage = newMainstage.filter(b => b.name !== this.draggedBand.name);
                } else if (this.dragSource === 'kerk') {
                    newKerk = newKerk.filter(b => b.name !== this.draggedBand.name);
                }

                if (targetZone === 'mainstage') {
                    if (targetIndex !== null) {
                        newMainstage.splice(targetIndex, 0, this.draggedBand);
                    } else {
                        newMainstage.push(this.draggedBand);
                    }
                } else if (targetZone === 'kerk') {
                    if (targetIndex !== null) {
                        newKerk.splice(targetIndex, 0, this.draggedBand);
                    } else {
                        newKerk.push(this.draggedBand);
                    }
                } else if (targetZone === 'available') {
                    newAvailable.push(this.draggedBand);
                }

                scenario.mainstage = newMainstage;
                scenario.kerk = newKerk;
                scenario.available = newAvailable;

                this.draggedBand = null;
                this.dragSource = null;
                this.saveScenarios();
                this.render();
            }

            renderPoster() {
                const scenario = this.getActiveScenario();
                const mainstageTotal = scenario.mainstage.reduce((s, b) => s + b.price, 0);
                const kerkTotal = scenario.kerk.reduce((s, b) => s + b.price, 0);

                return `
                    <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div class="bg-white rounded-3xl p-8 max-w-3xl">
                            <div id="poster" class="relative rounded-3xl overflow-hidden" style="width: 700px; height: 900px; background-color: #FFB7B2;">
                                <div style="position: absolute; width: 200%; height: 200%; top: -50%; left: -50%; transform: rotate(45deg); z-index: 0;">
                                    <div style="background: #FF9AA2; height: 100px;"></div>
                                    <div style="background: #FFB7B2; height: 100px;"></div>
                                    <div style="background: #FFDAC1; height: 100px;"></div>
                                    <div style="background: #FFB7B2; height: 100px;"></div>
                                    <div style="background: #FF9AA2; height: 100px;"></div>
                                    <div style="background: #FFB7B2; height: 100px;"></div>
                                    <div style="background: #FFDAC1; height: 100px;"></div>
                                    <div style="background: #FFB7B2; height: 100px;"></div>
                                    <div style="background: #FF9AA2; height: 100px;"></div>
                                    <div style="background: #FFB7B2; height: 100px;"></div>
                                    <div style="background: #FFDAC1; height: 100px;"></div>
                                    <div style="background: #FFB7B2; height: 100px;"></div>
                                </div>
                                
                                <div style="position: relative; z-index: 10; padding: 4rem;">
                                    <h1 style="font-family: 'Fredoka', sans-serif; font-size: 4.5rem; font-weight: 700; color: #1a2238; text-align: center; margin: 0 0 2rem 0; line-height: 1.1;">
                                        Line-up<br>RoZa 2026
                                    </h1>
                                    
                                    <div style="background: #FFFFFF; border-radius: 1rem; padding: 1.5rem; margin: 0 auto 3rem auto; max-width: 400px;">
                                        <p style="font-family: 'Fredoka', sans-serif; font-size: 2rem; font-weight: 700; color: #1a2238; text-align: center; margin: 0 0 0.5rem 0;">
                                            ${this.CONFIG.datum}
                                        </p>
                                        <p style="font-family: 'Fredoka', sans-serif; font-size: 1.25rem; font-weight: 400; color: #1a2238; text-align: center; margin: 0;">
                                            ${this.CONFIG.locatie}
                                        </p>
                                    </div>

                                    <div style="display: flex; gap: 2rem; margin-bottom: 2rem;">
                                        <div style="flex: 1; background: #1a2238; padding: 1.5rem; border-radius: 1rem;">
                                            <h2 style="font-family: 'Fredoka', sans-serif; font-size: 1.5rem; font-weight: 700; color: #FFB7B2; border-bottom: 2px solid #FFB7B2; padding-bottom: 0.5rem; margin: 0 0 1rem 0;">
                                                üé∏ MAINSTAGE
                                            </h2>
                                            ${scenario.mainstage.map((band, idx) => `
                                                <p style="font-family: 'Fredoka', sans-serif; color: #FFFFFF; margin: 0 0 0.5rem 0; ${idx === scenario.mainstage.length - 1 ? 'font-size: 1.5rem; font-weight: 700; margin-top: 1rem;' : 'font-size: 1.125rem; font-weight: 400;'}">
                                                    ${band.name}
                                                </p>
                                            `).join('')}
                                        </div>

                                        <div style="flex: 1; background: #1a2238; padding: 1.5rem; border-radius: 1rem;">
                                            <h2 style="font-family: 'Fredoka', sans-serif; font-size: 1.5rem; font-weight: 700; color: #FFB7B2; border-bottom: 2px solid #FFB7B2; padding-bottom: 0.5rem; margin: 0 0 1rem 0;">
                                                ‚õ™ KERK
                                            </h2>
                                            ${scenario.kerk.map(band => `
                                                <p style="font-family: 'Fredoka', sans-serif; font-size: 1.125rem; font-weight: 400; color: #FFFFFF; margin: 0 0 0.5rem 0;">
                                                    ${band.name}
                                                </p>
                                            `).join('')}
                                        </div>
                                    </div>

                                    <div style="background: #FFFFFF; border-radius: 1rem; padding: 1rem;">
                                        <p style="font-family: 'Fredoka', sans-serif; font-size: 0.875rem; font-weight: 600; color: #1a2238; text-align: center; margin: 0;">
                                            ${scenario.name} ‚Ä¢ ‚Ç¨${mainstageTotal + kerkTotal} budget
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-6 text-center">
                                <button onclick="app.showPosterView = false; app.render()" 
                                    class="bg-[#1a2238] text-white px-8 py-3 rounded-2xl hover:bg-[#2a3248] font-bold text-lg">
                                    Sluiten
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            render() {
                if (!this.currentUser || this.isLoading) return;

                const scenario = this.getActiveScenario();
                const mainstageTotal = scenario.mainstage.reduce((s, b) => s + b.price, 0);
                const kerkTotal = scenario.kerk.reduce((s, b) => s + b.price, 0);
                const totalSpent = mainstageTotal + kerkTotal;
                const remaining = this.CONFIG.totaleBudget - totalSpent;

                const kanshebbers = scenario.available.filter(b => b.viable).sort((a, b) => b.price - a.price);
                const nietVoorRoza = scenario.available.filter(b => !b.viable).sort((a, b) => b.price - a.price);

                const app = document.getElementById('app');
                app.innerHTML = `
                    ${this.showPosterView ? this.renderPoster() : ''}
                    
                    <div class="min-h-screen roza-bg p-6">
                        <div class="max-w-7xl mx-auto">
                            <div class="flex justify-between items-center mb-6">
                                <div>
                                    <h1 class="text-5xl font-bold roza-title">Hey RoZa, you're in!</h1>
                                    <p class="text-[#1a2238] text-lg font-semibold opacity-80">${this.CONFIG.datum} ‚Ä¢ ${this.CONFIG.locatie}</p>
                                </div>
                                <div class="flex items-center gap-4">
                                    <button onclick="app.importScenario()" 
                                        class="bg-[#1a2238] text-white px-5 py-3 rounded-2xl hover:bg-[#2a3248] flex items-center gap-2 font-bold">
                                        üì• Importeer
                                    </button>
                                    <button onclick="app.generatePoster()" 
                                        class="bg-[#1a2238] text-white px-5 py-3 rounded-2xl hover:bg-[#2a3248] flex items-center gap-2 font-bold">
                                        üé® Maak Poster
                                    </button>
                                    <div class="text-right bg-white rounded-2xl px-4 py-2">
                                        <div class="text-sm text-gray-600">Ingelogd als</div>
                                        <div class="font-bold roza-title">${this.currentUser}</div>
                                        <button onclick="app.logout()" class="text-xs text-red-600 hover:underline font-semibold">
                                            Uitloggen
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-2xl shadow-lg p-4 mb-6">
                                <div class="flex items-center gap-2 overflow-x-auto pb-2">
                                    ${this.scenarios.map(s => `
                                        <div class="flex items-center gap-2 px-5 py-3 rounded-2xl cursor-pointer transition-all ${
                                            this.activeScenarioId === s.id
                                                ? 'bg-[#1a2238] text-white'
                                                : 'bg-[#FFE5E5] text-[#1a2238] hover:bg-[#FFD5D5]'
                                        }">
                                            ${this.editingScenarioId === s.id ? `
                                                <input 
                                                    type="text" 
                                                    value="${this.editName}"
                                                    onchange="app.editName = this.value"
                                                    onblur="app.renameScenario(${s.id}, this.value)"
                                                    onkeydown="if(event.key==='Enter') app.renameScenario(${s.id}, this.value); if(event.key==='Escape') { app.editingScenarioId=null; app.render(); }"
                                                    class="bg-white text-[#1a2238] px-3 py-2 rounded-xl w-32 font-bold"
                                                    autofocus
                                                >
                                            ` : `
                                                <span onclick="app.activeScenarioId = ${s.id}; app.saveScenarios(); app.render()" class="font-bold">
                                                    ${s.name}
                                                </span>
                                            `}
                                            
                                            ${this.activeScenarioId === s.id ? `
                                                <div class="flex items-center gap-1">
                                                    <button onclick="app.editingScenarioId = ${s.id}; app.editName = '${s.name}'; app.render()" 
                                                        class="p-1 hover:bg-[#2a3248] rounded-lg" title="Hernoemen">
                                                        ‚úèÔ∏è
                                                    </button>
                                                    <button onclick="app.exportScenario(${s.id})" 
                                                        class="p-1 hover:bg-[#2a3248] rounded-lg" title="Exporteren">
                                                        üíæ
                                                    </button>
                                                    <button onclick="app.duplicateScenario(${s.id})" 
                                                        class="p-1 hover:bg-[#2a3248] rounded-lg" title="Dupliceren">
                                                        üìã
                                                    </button>
                                                    ${this.scenarios.length > 1 ? `
                                                        <button onclick="app.deleteScenario(${s.id})" 
                                                            class="p-1 hover:bg-red-600 rounded-lg" title="Verwijderen">
                                                            üóëÔ∏è
                                                        </button>
                                                    ` : ''}
                                                </div>
                                            ` : ''}
                                            <div class="text-xs opacity-75">door ${s.createdBy}</div>
                                        </div>
                                    `).join('')}
                                    <button onclick="app.addScenario()" 
                                        class="flex items-center gap-2 px-5 py-3 bg-[#1a2238] text-white rounded-2xl hover:bg-[#2a3248] transition-all whitespace-nowrap font-bold">
                                        ‚ûï Nieuw
                                    </button>
                                </div>
                            </div>

                            <div class="bg-white rounded-2xl shadow-lg p-6 mb-6">
                                <div class="grid grid-cols-4 gap-4">
                                    <div class="text-center bg-[#FFE5E5] rounded-2xl p-4">
                                        <div class="text-sm text-[#1a2238] mb-1 font-semibold">Totaal Budget</div>
                                        <div class="text-3xl font-bold roza-title">‚Ç¨${this.CONFIG.totaleBudget}</div>
                                    </div>
                                    <div class="text-center bg-[#E3F2FD] rounded-2xl p-4">
                                        <div class="text-sm text-[#1a2238] mb-1 font-semibold">Mainstage</div>
                                        <div class="text-3xl font-bold text-blue-600">‚Ç¨${mainstageTotal}</div>
                                        <div class="text-xs text-gray-600 font-semibold">${scenario.mainstage.length} acts</div>
                                    </div>
                                    <div class="text-center bg-[#F3E5F5] rounded-2xl p-4">
                                        <div class="text-sm text-[#1a2238] mb-1 font-semibold">Kerk</div>
                                        <div class="text-3xl font-bold text-purple-600">‚Ç¨${kerkTotal}</div>
                                        <div class="text-xs text-gray-600 font-semibold">${scenario.kerk.length} acts</div>
                                    </div>
                                    <div class="text-center ${remaining >= 0 ? 'bg-[#E8F5E9]' : 'bg-[#FFEBEE]'} rounded-2xl p-4">
                                        <div class="text-sm text-[#1a2238] mb-1 font-semibold">Resterend</div>
                                        <div class="text-3xl font-bold ${remaining >= 0 ? 'text-green-600' : 'text-red-600'}">
                                            ‚Ç¨${remaining}
                                        </div>
                                        <div class="text-xs text-gray-600 font-semibold">
                                            ${remaining >= 0 ? '‚úÖ Binnen budget' : '‚ùå Over budget!'}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-3 gap-6">
                                <div class="bg-white rounded-2xl shadow-lg p-6">
                                    <h2 class="text-3xl font-bold roza-title mb-4 flex items-center gap-2">
                                        üé∏ Mainstage
                                    </h2>
                                    <div class="text-sm text-gray-600 mb-4 font-semibold">
                                        ${scenario.mainstage.length} acts ‚Ä¢ ‚Ç¨${mainstageTotal}
                                    </div>
                                    <div 
                                        ondragover="event.preventDefault()"
                                        ondrop="app.handleDrop('mainstage')"
                                        class="space-y-3 min-h-[400px] p-4 pl-10 bg-blue-50 rounded-2xl border-2 border-dashed border-blue-300">
                                        ${scenario.mainstage.map((band, idx) => `
                                            <div class="relative">
                                                <div class="absolute -left-8 top-1/2 -translate-y-1/2 w-7 h-7 bg-[#1a2238] text-white rounded-full flex items-center justify-center text-sm font-bold">
                                                    ${idx + 1}
                                                </div>
                                                <div 
                                                    draggable="true"
                                                    ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'mainstage'"
                                                    ondragover="event.preventDefault()"
                                                    ondrop="event.stopPropagation(); app.handleDrop('mainstage', ${idx})"
                                                    class="bg-white p-4 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-blue-400 transition-all">
                                                    <div class="flex justify-between items-start">
                                                        <div class="flex-1">
                                                            <div class="font-bold text-[#1a2238]">${band.name}</div>
                                                            ${band.category ? `<div class="text-xs text-gray-500 mt-1 font-semibold">${band.category}</div>` : ''}
                                                            ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                        </div>
                                                        <div class="text-right ml-3">
                                                            <div class="font-bold ${band.price === 0 ? 'text-gray-400' : 'text-green-600'}">
                                                                ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                        ${scenario.mainstage.length === 0 ? '<div class="text-center text-gray-400 py-8 font-semibold">Sleep bands hierheen</div>' : ''}
                                    </div>
                                </div>

                                <div class="bg-white rounded-2xl shadow-lg p-6">
                                    <h2 class="text-3xl font-bold roza-title mb-4 flex items-center gap-2">
                                        ‚õ™ Kerk
                                    </h2>
                                    <div class="text-sm text-gray-600 mb-4 font-semibold">
                                        ${scenario.kerk.length} acts ‚Ä¢ ‚Ç¨${kerkTotal}
                                    </div>
                                    <div 
                                        ondragover="event.preventDefault()"
                                        ondrop="app.handleDrop('kerk')"
                                        class="space-y-3 min-h-[400px] p-4 pl-10 bg-purple-50 rounded-2xl border-2 border-dashed border-purple-300">
                                        ${scenario.kerk.map((band, idx) => `
                                            <div class="relative">
                                                <div class="absolute -left-8 top-1/2 -translate-y-1/2 w-7 h-7 bg-[#1a2238] text-white rounded-full flex items-center justify-center text-sm font-bold">
                                                    ${idx + 1}
                                                </div>
                                                <div 
                                                    draggable="true"
                                                    ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'kerk'"
                                                    ondragover="event.preventDefault()"
                                                    ondrop="event.stopPropagation(); app.handleDrop('kerk', ${idx})"
                                                    class="bg-white p-4 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-purple-400 transition-all">
                                                    <div class="flex justify-between items-start">
                                                        <div class="flex-1">
                                                            <div class="font-bold text-[#1a2238]">${band.name}</div>
                                                            ${band.category ? `<div class="text-xs text-gray-500 mt-1 font-semibold">${band.category}</div>` : ''}
                                                            ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                        </div>
                                                        <div class="text-right ml-3">
                                                            <div class="font-bold ${band.price === 0 ? 'text-gray-400' : 'text-green-600'}">
                                                                ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        `).join('')}
                                        ${scenario.kerk.length === 0 ? '<div class="text-center text-gray-400 py-8 font-semibold">Sleep bands hierheen</div>' : ''}
                                    </div>
                                </div>

                                <div class="bg-white rounded-2xl shadow-lg p-6">
                                    <h2 class="text-3xl font-bold roza-title mb-4 flex items-center gap-2">
                                        üí∞ Beschikbaar
                                    </h2>
                                    
                                    <div class="space-y-6 max-h-[600px] overflow-y-auto">
                                        <div>
                                            <div class="flex items-center gap-2 mb-3 sticky top-0 bg-white py-2 z-10">
                                                <span class="text-yellow-500">‚≠ê</span>
                                                <h3 class="font-bold text-green-700">Kanshebbers</h3>
                                                <span class="text-sm text-gray-500 font-semibold">(${kanshebbers.length})</span>
                                            </div>
                                            <div 
                                                ondragover="event.preventDefault()"
                                                ondrop="app.handleDrop('available')"
                                                class="space-y-3 p-4 bg-green-50 rounded-2xl">
                                                ${kanshebbers.map(band => `
                                                    <div 
                                                        draggable="true"
                                                        ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'available'"
                                                        class="bg-white p-3 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-green-400 transition-all">
                                                        <div class="flex justify-between items-start">
                                                            <div class="flex-1">
                                                                <div class="font-bold text-[#1a2238]">${band.name}</div>
                                                                ${band.category ? `<div class="text-xs text-gray-500 mt-1 font-semibold">${band.category}</div>` : ''}
                                                                ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                            </div>
                                                            <div class="text-right ml-3">
                                                                <div class="font-bold ${band.price === 0 ? 'text-gray-400' : 'text-green-600'}">
                                                                    ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>

                                        <div>
                                            <div class="flex items-center gap-2 mb-3 sticky top-0 bg-white py-2 z-10">
                                                <span class="text-red-500">‚ùå</span>
                                                <h3 class="font-bold text-red-700">Niet voor RoZa 2026</h3>
                                                <span class="text-sm text-gray-500 font-semibold">(${nietVoorRoza.length})</span>
                                            </div>
                                            <div 
                                                ondragover="event.preventDefault()"
                                                ondrop="app.handleDrop('available')"
                                                class="space-y-3 p-4 bg-red-50 rounded-2xl">
                                                ${nietVoorRoza.map(band => `
                                                    <div 
                                                        draggable="true"
                                                        ondragstart="app.draggedBand = ${JSON.stringify(band).replace(/"/g, '&quot;')}; app.dragSource = 'available'"
                                                        class="bg-white p-3 rounded-xl shadow-sm border-2 border-gray-200 cursor-move hover:border-red-400 transition-all">
                                                        <div class="flex justify-between items-start">
                                                            <div class="flex-1">
                                                                <div class="font-bold text-[#1a2238]">${band.name}</div>
                                                                ${band.category ? `<div class="text-xs text-gray-500 mt-1 font-semibold">${band.category}</div>` : ''}
                                                                ${band.info ? `<div class="text-xs text-blue-600 mt-1">${band.info}</div>` : ''}
                                                            </div>
                                                            <div class="text-right ml-3">
                                                                <div class="font-bold ${band.price === 0 ? 'text-gray-400' : 'text-green-600'}">
                                                                    ${band.price === 0 ? '?' : '‚Ç¨' + band.price}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                `).join('')}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        const app = new FestivalApp();
        window.app = app;
    </script>
</body>
</html>
